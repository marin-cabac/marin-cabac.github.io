// Add a counter variable to control enemy speed
let enemyMoveCounter = 0;
const enemySpeed = 5; // Adjust this value to control speed (higher means slower)

// Update game elements
function update() {
    // Move bullets
    bullets = bullets.map(b => ({ x: b.x, y: b.y - 1 })).filter(b => b.y >= 0);

    // Spawn enemies randomly
    if (Math.random() < 0.1) {
        enemies.push({ x: Math.floor(Math.random() * width), y: 0 });
    }

    // Move enemies at a slower rate based on counter
    enemyMoveCounter++;
    if (enemyMoveCounter >= enemySpeed) {
        enemies = enemies.map(e => ({ x: e.x, y: e.y + 1 }));
        enemyMoveCounter = 0; // Reset the counter after moving enemies
    }

    // Check for collisions
    bullets.forEach((bullet, bulletIdx) => {
        enemies.forEach((enemy, enemyIdx) => {
            if (bullet.x === enemy.x && bullet.y === enemy.y) {
                bullets.splice(bulletIdx, 1); // remove bullet
                enemies.splice(enemyIdx, 1); // remove enemy
                score++;
            }
        });
    });

    // Remove off-screen enemies
    enemies = enemies.filter(e => e.y < height);

    // Check game over condition
    if (enemies.some(e => e.y === height - 1)) {
        alert("Game Over! Score: " + score);
        enemies = [];
        bullets = [];
        score = 0;
    }

    render();
}
