<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ASCII Space Invaders</title>
    <style>
        body {
            font-family: monospace;
            color: lime;
            background-color: black;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            overflow: hidden;
            margin: 0;
            flex-direction: column;
        }
        #game {
            width: 40ch; /* Increased width to allow more movement */
            height: 20em;
            white-space: pre;
            font-size: 20px;
            border: 2px solid lime;
            margin-bottom: 10px;
            position: relative;
        }
        #score {
            position: absolute;
            top: 5px;
            left: 5px;
            font-size: 16px;
        }
    </style>
</head>
<body>
    <div id="game">
        <div id="score">Score: 0</div>
    </div>
    <script>
        const game = document.getElementById("game");
        const scoreDisplay = document.getElementById("score");
        const width = 40; // game area width
        const height = 20; // game area height

        let spaceshipPos = Math.floor(width / 2) - 2; // Center the spaceship under bullets
        let bullets = [];
        let enemies = [];
        let score = 0;

        // Counter to control enemy speed
        let enemyMoveCounter = 0;
        const enemySpeed = 5; // Increase this value to slow down enemies

        // Update game display
        function render() {
            let output = "";

            // Render enemies and the spaceship
            for (let y = 0; y < height; y++) {
                let line = "";
                for (let x = 0; x < width; x++) {
                    if (y === height - 1 && x === spaceshipPos) {
                        line += "<=!=>"; // spaceship
                        x += 4;
                    } else if (bullets.some(b => b.x === x && b.y === y)) {
                        line += "o"; // bullet
                    } else if (enemies.some(e => e.x === x && e.y === y)) {
                        line += "M"; // enemy
                    } else {
                        line += " "; // empty space
                    }
                }
                output += line + "\n";
            }
            game.textContent = output;
            scoreDisplay.textContent = `Score: ${score}`;
        }

        // Move spaceship left and right
        document.addEventListener("keydown", e => {
            if (e.key === "ArrowLeft" && spaceshipPos > 0) {
                spaceshipPos = Math.max(spaceshipPos - 1, 0); // Move left
            } else if (e.key === "ArrowRight" && spaceshipPos < width - 5) {
                spaceshipPos = Math.min(spaceshipPos + 1, width - 5); // Move right
            } else if (e.key === " ") {
                bullets.push({ x: spaceshipPos + 2, y: height - 2 }); // Fire bullet from center
            }
            render();
        });

        // Update game elements
        function update() {
            // Move bullets
            bullets = bullets.map(b => ({ x: b.x, y: b.y - 1 })).filter(b => b.y >= 0);

            // Spawn enemies randomly
            if (Math.random() < 0.1) {
                enemies.push({ x: Math.floor(Math.random() * width), y: 0 });
            }

            // Move enemies at a slower rate based on counter
            enemyMoveCounter++;
            if (enemyMoveCounter >= enemySpeed) {
                enemies = enemies.map(e => ({ x: e.x, y: e.y + 1 }));
                enemyMoveCounter = 0; // Reset the counter after moving enemies
            }

            // Check for collisions
            bullets.forEach((bullet, bulletIdx) => {
                enemies.forEach((enemy, enemyIdx) => {
                    if (bullet.x === enemy.x && bullet.y === enemy.y) {
                        bullets.splice(bulletIdx, 1); // remove bullet
                        enemies.splice(enemyIdx, 1); // remove enemy
                        score++;
                    }
                });
            });

            // Remove off-screen enemies
            enemies = enemies.filter(e => e.y < height);

            render();
        }

        // Game loop
        setInterval(update, 100);
        render();
    </script>
</body>
</html>
